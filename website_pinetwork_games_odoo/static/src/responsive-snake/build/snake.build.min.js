/*! responsive-snake - v0.1.4 - 2014-06-20 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){this.options=$.extend({enabled:!1,directions:{UP:0,DOWN:2,LEFT:1,RIGHT:3}},a),this.enabled=this.options.enabled}c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.getNextMove=function(a,b,c,d,e){for(var f=0,g={x:a[0].x,y:a[0].y},h=this.getPrelimDirection(g,b,e);!this.isMoveSafe(a,g,d,h,e)&&f++<=4;)h=(h+1)%4;return h},c.prototype.getPrelimDirection=function(a,b,c){return Math.abs(a.x-b.x)>Math.abs(a.y-b.y)?a.x>b.x?c.LEFT:c.RIGHT:a.y<b.y||0===a.y?c.DOWN:c.UP},c.prototype.isMoveSafe=function(a,b,c,d,e){if(2===Math.abs(c-d))return!1;switch(d){case e.UP:b.y--;break;case e.DOWN:b.y++;break;case e.RIGHT:b.x++;break;case e.LEFT:default:b.x--}var f=!0;return a.forEach(function(a){a.x===b.x&&a.y===b.y&&(f=!1)}),f},b.exports=c},{}],2:[function(a,b){function c(a){this.options=a||{},this.width=this.options.width?this.options.width:10,this.x=this.options.x?this.options.x:0,this.y=this.options.y?this.options.y:0,this.border=this.options.border?this.options.border:!1,this.color=this.options.color?this.options.color:"#FFF"}c.prototype.draw=function(a){a.fillStyle=this.color,this.border&&(a.strokeStyle=this.border),a.fillRect(this.x*this.width,this.y*this.width,this.width,this.width),a.strokeRect(this.x*this.width,this.y*this.width,this.width,this.width)},b.exports=c},{}],3:[function(a,b){var c=a("./util/cookie"),d=function(a){if(this.started=!1,this.disabled=!1,this.score=0,this.settings=$.extend({inst:!1},a),this.inst=this.settings.inst,!this.inst)throw new Error("A Game Instance Must Be Supplied");this.ui={canvas:$("#snake-canvas"),scoreboard:$("#score span","#scoreboard"),userScore:$("#hi-score span","#scoreboard"),botScore:$("#bot-hi-score span","#scoreboard")},this.keys={user:this.inst.name+"_user",bot:this.inst.name+"_bot"},this.$canvas=this.inst.$canvas,this.updateScoreboard(),this.bindEvents()};d.prototype.start=function(){this.started=!0,this.inst.start()},d.prototype.bindEvents=function(){$(document).on("keydown",this.onKeydown.bind(this)),$(window).on("resize",this.onResize.bind(this)),this.inst.onRestart=this.onGameRestart.bind(this),this.inst.onScore=this.onGameScore.bind(this),this.bindTouchEvents()},d.prototype.bindTouchEvents=function(){var a=this,b=this.inst.queueDirection.bind(this.inst);this.ui.canvas.on("touchmove",function(a){a.preventDefault()}),this.ui.canvas.on("swipeUp",function(){b(a.inst.DIRECTIONS.UP)}),this.ui.canvas.on("swipeDown",function(){b(a.inst.DIRECTIONS.DOWN)}),this.ui.canvas.on("swipeLeft",function(){b(a.inst.DIRECTIONS.LEFT)}),this.ui.canvas.on("swipeRight",function(){b(a.inst.DIRECTIONS.RIGHT)})},d.prototype.play=function(){this.started=!0,this.inst.play()},d.prototype.pause=function(){this.started=!1,this.inst.pause()},d.prototype.enableGame=function(){this.disabled=!1,this.$canvas.show(),this.play()},d.prototype.disableGame=function(){this.disabled=!0,this.$canvas.hide(),this.pause()},d.prototype.saveGame=function(a){var b=c.read(this.keys.user)||0;if(this.inst.bot&&this.inst.bot.enabled){var d=c.read(this.keys.bot)||0;d&&d>a&&(a=d),c.create(this.keys.bot,a)}else(!b||b&&a>b)&&c.create(this.keys.user,a)},d.prototype.updateScoreboard=function(a){this.updateScore(a||0),this.ui.userScore.text(c.read(this.keys.user)||0),this.inst.bot&&this.ui.botScore.text(c.read(this.keys.bot)||0)},d.prototype.updateScore=function(a){var b=this.ui.scoreboard;b.text(a).addClass("flash"),setTimeout(function(){b.removeClass("flash")},1e3)},d.prototype.onGameScore=function(a){this.updateScore(a)},d.prototype.onGameRestart=function(a){this.saveGame(a),this.updateScoreboard()},d.prototype.toggleGame=function(){this.disabled?this.enableGame():this.disableGame()},d.prototype.onResize=function(){"function"==typeof this.inst.onResize&&this.inst.onResize(window.innerHeight,window.innerWidth)},d.prototype.onKeydown=function(a){switch(a.keyCode){case 38:this.inst.queueDirection(this.inst.DIRECTIONS.UP);break;case 40:this.inst.queueDirection(this.inst.DIRECTIONS.DOWN);break;case 37:this.inst.queueDirection(this.inst.DIRECTIONS.LEFT);break;case 39:this.inst.queueDirection(this.inst.DIRECTIONS.RIGHT);break;case 187:this.inst.increaseFPS(1);break;case 189:this.inst.decreaseFPS(1);break;case 66:this.inst.bot&&this.inst.bot.enable();break;case 82:this.inst.restart();break;case 79:this.toggleGame();break;case 32:this.disabled||(this.started?this.pause():this.play())}},b.exports=d},{"./util/cookie":8}],4:[function(a,b){function c(a){this.options=a||{},this.x=this.options.x,this.y=this.options.y,this.decay=this.options.hasOwnProperty("decay")&&this.options.decay,this.life=100,this.velocity={x:-5+10*Math.random(),y:-8+10*Math.random()},this.radius=parseInt(5*Math.random()),this.color=this.options.color?this.options.color:this.getBW(),this.border=this.options.border?this.options.border:null}c.prototype.getBW=function(){var a=!(Math.random()+.5|0)==!0?255:0;return"rgb("+parseInt(a)+","+parseInt(a)+","+parseInt(a)+","+(this.decay?this.life/100:"1")+")"},c.prototype.draw=function(a){this.decay&&(this.life=~~(.96*this.life),this.radius=.96*this.radius),a.fillStyle=this.color,this.border&&(a.strokeStyle=this.border),a.beginPath(),a.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),a.fill(),a.closePath()},b.exports=c},{}],5:[function(a,b){function c(a){this.options=a||{},this.width=this.options.width?this.options.width:10,this.x=this.options.x?this.options.x:0,this.y=this.options.y?this.options.y:0,this.color=this.options.color||"#FFF",this.border=this.options.border||"#000"}c.prototype.updatePosition=function(a,b){this.x=a,this.y=b},c.prototype.draw=function(a,b){a.fillStyle="string"==typeof b?b:this.color,a.strokeStyle=this.border,a.fillRect(this.x*this.width,this.y*this.width,this.width,this.width),a.strokeRect(this.x*this.width,this.y*this.width,this.width,this.width)},b.exports=c},{}],6:[function(a,b){var c=a("./Piece"),d=a("./Food"),e=a("./Bot"),f=a("./Particle"),g=function(a){this.score=0,this.started=!1,this.fps=15,this.gravity=1,this.particles=[],this.particleCount=150,this.$canvas=$("canvas"),this.canvas=this.$canvas[0],this.context=this.canvas.getContext("2d"),this.$canvas.data("full-screen")&&(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight),this.animationTimeout=null,this.pieces=[],this.food=[],this.currentFoodColor=null,this.settings=$.extend({snakePixels:14,snakeSize:3,foodColor:null,headColor:"rgba(0,0,0,0)",bot:!1,timeout:1e3,explosion:!0},a),this.DIRECTIONS={UP:0,DOWN:2,LEFT:1,RIGHT:3},this.bot=new e({directions:this.DIRECTIONS,enabled:this.settings.bot}),this.direction=this.DIRECTIONS.RIGHT,this.directionQueue=[]};g.prototype.setOptions=function(a){$.extend(this.settings,a),this.settings.bot===!0&&this.bot.enable()},g.prototype.start=function(){this.started=!0,this.create(),this.createFood(),this.play()},g.prototype.reset=function(){this.started=!1,this.score=0,this.directionQueue=[],this.direction=this.DIRECTIONS.RIGHT,this.pieces=[],this.food=[],this.particles=[],this.gravity=1,this.fps=15,this.animationTimeout&&clearTimeout(this.animationTimeout)},g.prototype.restart=function(){"function"==typeof this.onRestart&&this.onRestart(this.score),this.reset(),this.start()},g.prototype.play=function(){this.started=!0,"function"==typeof this.animationLoop&&this.animationLoop()},g.prototype.pause=function(){this.started=!1},g.prototype.lose=function(){this.pause(),setTimeout(this.restart.bind(this),this.settings.timeout)},g.prototype.queueDirection=function(a){this.bot.enabled===!0&&this.bot.disable(),this.started&&this.directionQueue[this.directionQueue.length-1]!==a&&this.directionQueue.push(a)},g.prototype.onResize=function(a,b){this.canvas.width=b,this.canvas.height=a},g.prototype.create=function(){for(var a=0;a<this.settings.snakeSize;a++)this.pieces.push(new c({x:0,y:20,width:this.settings.snakePixels}))},g.prototype.createFood=function(){this.food.push(new d({x:Math.round(Math.random()*(this.canvas.width-this.settings.snakePixels)/this.settings.snakePixels),y:Math.round(Math.random()*(this.canvas.height-this.settings.snakePixels)/this.settings.snakePixels),width:this.settings.snakePixels,color:this.getFoodColor(),border:"#000"}))},g.prototype.getFoodColor=function(){return this.settings.foodColor?this.settings.foodColor:(this.currentFoodColor="rgb("+parseInt(255*Math.random())+","+parseInt(255*Math.random())+","+parseInt(255*Math.random())+")",this.currentFoodColor)},g.prototype.getDirection=function(){for(var a;"undefined"==typeof a||(this.direction-a+4)%4===2;)a=this.directionQueue.length>0?this.directionQueue.shift():this.direction;return a},g.prototype.isWallCollision=function(a,b){var c=-1===b,d=a>=this.canvas.width/this.settings.snakePixels,e=b>=this.canvas.height/this.settings.snakePixels,f=-1===a;return c||d||e||f},g.prototype.isSelfCollision=function(a,b){for(var c=0;c<this.pieces.length;c++)if(this.pieces[c].x==a&&this.pieces[c].y==b)return!0;return!1},g.prototype.isFoodCollision=function(a,b){var c=!1;return this.food.forEach(function(d){a==d.x&&b==d.y&&(c=!0)}),c},g.prototype.removeFood=function(a,b){var c=this;this.food.forEach(function(d,e){a==d.x&&b==d.y&&c.food.splice(e)})},g.prototype.createExplosion=function(a,b){for(var c=0;c<this.particleCount;c++){var d=new f({x:a*this.settings.snakePixels,y:b*this.settings.snakePixels,color:this.settings.foodColor?this.settings.foodColor:this.currentFoodColor,decay:!0});this.particles.push(d)}},g.prototype.scorePoint=function(){this.score++,this.onScore&&"function"==typeof this.onScore&&this.onScore(this.score)},g.prototype.increaseFPS=function(a){this.fps+=a},g.prototype.decreaseFPS=function(a){this.fps-a>0&&(this.fps-=a)},g.prototype.drawLoop=function(){var a=this;if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.pieces.length){var b=this.pieces[0].x,d=this.pieces[0].y;switch(this.direction=this.getDirection(),this.bot&&this.bot.enabled===!0&&(this.direction=this.bot.getNextMove(this.pieces,this.food[0],{x:b,y:d},this.direction,this.DIRECTIONS)),this.direction){case this.DIRECTIONS.LEFT:b--;break;case this.DIRECTIONS.RIGHT:b++;break;case this.DIRECTIONS.UP:d--;break;case this.DIRECTIONS.DOWN:d++}if((this.isWallCollision(b,d)||this.isSelfCollision(b,d))&&this.lose(),this.started){var e=null,f=this.isFoodCollision(b,d);f?(this.scorePoint(),this.score%2&&(this.fps+=.5),this.settings.explosion&&this.createExplosion(b,d,[f.color,f.border]),this.removeFood(b,d),this.createFood(),e=new c({x:b,y:d,width:this.settings.snakePixels})):(e=this.pieces.pop(),e.updatePosition(b,d)),this.pieces.unshift(e)}this.pieces.forEach(function(b,c){b.draw(a.context,0===c?a.settings.headColor:null)}),this.food.forEach(function(b){b.draw(a.context)})}},g.prototype.animationLoop=function(){if(this.started){var a=this;this.animationTimeout&&clearTimeout(this.animationTimeout),this.animationTimeout=setTimeout(function(){a.drawLoop.call(a),a.particleLoop.call(a),window.requestAnimationFrame(a.animationLoop.bind(a))},1e3/this.fps)}},g.prototype.particleLoop=function(){if(this.particles){var a=this,b=[];this.particles.forEach(function(c){c.velocity.y+=a.gravity,c.x+=c.velocity.x,c.y+=c.velocity.y,c.draw(a.context),c.y<1.1*a.canvas.height&&b.push(c)}),this.particles=b}},b.exports=g},{"./Bot":1,"./Food":2,"./Particle":4,"./Piece":5}],7:[function(a,b){var c=a("./GameContainer"),d=a("./SnakeGame"),e={game:new c({inst:new d}),start:function(a){a&&e.game.inst.setOptions(a),e.game.start(),e.bindEvents()},bindEvents:function(){this.game.started&&$(window).focus(function(){this.game.started&&this.game.play.bind(this.game)}.bind(this)).blur(function(){this.game.started&&this.game.pause.bind(this.game)}.bind(this))}};"undefined"==typeof b||window?"undefined"!=typeof window&&(window.ResponsiveSnake=e):b.exports=e},{"./GameContainer":3,"./SnakeGame":6}],8:[function(a,b){b.exports={create:function(a,b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="expires="+d.toGMTString();document.cookie=a+"="+b+"; "+e},read:function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c].trim();if(0===d.indexOf(a))return d.substring(a.length,d.length)}return!1},remove:function(a){this.create(a,"",-1)}}},{}]},{},[7]);